<LDAP>
  URL <%= scope.lookupvar('ldap_server') %>
  BindDN <%= scope.lookupvar('ldap_binddn') %>
  Password <%= scope.lookupvar('ldap_bindpass') %>
  Timeout 15
  TLSEnable no
  FollowReferrals no
  TLSCACertFile /usr/local/etc/ssl/ca.pem
  TLSCACertDir /etc/ssl/certs
  TLSCertFile /usr/local/etc/ssl/client-cert.pem
  TLSKeyFile /usr/local/etc/ssl/client-key.pem
</LDAP>

<Authorization>
  BaseDN <%= scope.lookupvar('ldap_u_basedn') %>
  SearchFilter "(&(sAMAccountName=%u))"
  RequireGroup <%= scope.lookupvar('ldap_gmember') %>

<% if scope.lookupvar('ldap_gmember') == true -%>
  <Group>
    BaseDN <%= scope.lookupvar('ldap_g_basedn') %>
    SearchFilter <%= scope.lookupvar('ldap_filter') %>
    MemberAttribute <%= scope.lookupvar('ldap_memberatr') %>
  </Group>
<% end -%>
</Authorization>
